<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0/dist/chartjs-plugin-annotation.min.js"></script>
    <link rel="stylesheet" href="./assets/Styles/dash.css" />
  </head>
  <body>
    <div class="kpiData">Última Atualização: <span id="dataHora"></span></div>

    <div class="main">
      <div class="sidebar">
        <div class="profile">
          <img src="./assets/Imgs/account.png" alt="Perfil" />

          <h1>Olá, Brandão!</h1>
        </div>

        <a href="./dashboard.html">Visão Geral</a>
        <a href="./detalhes.html">Histórico de Alertas</a>
        <a href="./cadastro-dryflow.html">Cadastrar Novo Usúario</a>

        <a href="./index.html" class="logout-btn">
          Sign-out
          <img
            src="./assets/Imgs/logout.png"
            alt="Logout"
            class="logout-icon"
          />
        </a>
      </div>
      <div class="container">teste</div>
    </div>
  </body>
</html>
<script>
  function atualizarDataHora() {
    const agora = new Date();
    const dataHoraFormatada = agora.toLocaleString("pt-BR"); // horario e data brasileiros
    document.getElementById("dataHora").textContent = dataHoraFormatada;
  }

  // Atualiza a hora quanto recarrega a pagina
  atualizarDataHora();
</script>
<script>
  function atualizarKPIs(dados, limite = 50) {
    let perto = 0;
    let noLimite = 0;
    let acima = 0;

    dados.forEach((valor) => {
      if (valor > limite) {
        acima++;
      } else if (valor < limite && valor < limite - 5) {
        noLimite++;
      } else if (valor >= limite - 5 && valor <= limite) {
        perto++;
      }
    });

    document.getElementById("kpi-perto").textContent = perto;
    document.getElementById("kpi-no-limite").textContent = noLimite;
    document.getElementById("kpi-acima").textContent = acima;
  }
</script>

<script>
  // dados sem estar no gráfico
  const dadosUmidade = [80, 84, 47, 43];
  // atualiza as KPIs com base nos dados inseridos manualmente, não os dados do gráfico
  atualizarKPIs(dadosUmidade);
</script>

<script>
  /* SCRIPT do WEBDATAVIZ (cards.html) para gerar os cards de alerta de umidade */
  function exibirAquarios() {
    JSON.parse(sessionStorage.AQUARIOS).forEach((item) => {
      document.getElementById("cardAquarios").innerHTML += `
                  <div class="cardDinamico">
                    <h4>${item.modelo}</h4>
                    <p>ID Compressor: ${item.idCompressor}</p>
                    <p>Oficina: Brandão Car's</p>
                    <p>Umidade Atual: 80%</p>
                    <p>Nível de Risco: <span class="alto">Alto</span></p>
                  </div>
                  <br>
                  `;
    });
  }
  function verCompressorEspecifico() {
    window.location = "compressorDetalhes.html";
  }
</script>
